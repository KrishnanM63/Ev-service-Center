{% extends 'base.html' %}

{% block title %}Welcome {{ admin_name }} | Admin Dashboard{% endblock %}

{% block content %}
<section class="container my-5">

  <!-- Header -->
  <div class="card text-center shadow-sm p-4 mb-5 my-5">
    <h2 class="mb-0 text-success">Welcome, {{ admin_name }}!</h2>
  </div>

  <!-- Dashboard Stats -->
  <div class="row g-4 mb-5 text-center">
      <div class="col-md-4">
          <div class="card p-4 shadow-sm">
              <h5>Total Users</h5>
              <h2 class="text-danger">{{ total_users }}</h2>
          </div>
      </div>
      <div class="col-md-4">
          <div class="card p-4 shadow-sm">
              <h5>Total Bookings</h5>
              <h2 class="text-danger">{{ total_bookings }}</h2>
          </div>
      </div>
      <div class="col-md-4">
          <div class="card p-4 shadow-sm">
              <h5>Total Services</h5>
              <h2 class="text-danger">{{ total_services }}</h2>
          </div>
      </div>
  </div>

  <!-- Branch Owners -->
  <div class="mb-5">
      <h4 class="mb-3">Branch Owners</h4>
      <table class="table table-striped table-bordered">
          <thead class="table-dark">
              <tr>
                  <th>Branch Name</th>
                  <th>Owner</th>
                  <th>Contact</th>
                  <th>Location</th>
              </tr>
          </thead>
          <tbody>
              {% for owner in branch_owners %}
              <tr>
                  <td>{{ owner.branch_name }}</td>
                  <td>{{ owner.username }}</td>
                  <td>{{ owner.contact }}</td>
                  <td>{{ owner.location }}</td>
              </tr>
              {% empty %}
              <tr><td colspan="3" class="text-center">No branch owners found</td></tr>
              {% endfor %}
          </tbody>
      </table>
  </div>

  <!-- Booking Requests -->
  <div class="mb-5">
      <h4 class="mb-3">Pending Booking Requests</h4>
      <table class="table table-striped table-bordered">
          <thead class="table-dark">
              <tr>
                  <th>User</th>
                  <th>Service</th>
                  <th>Branch</th>
                  <th>Date</th>
                  <th>Action</th>
              </tr>
          </thead>
          <tbody>
              {% for booking in booking_requests %}
              <tr>
                  <td>{{ booking.user.username }}</td>
                  <td>{{ booking.service.name }}</td>
                  <td>{{ booking.branch_owner.branch_name }}</td>
                  <td>{{ booking.date|date:"d M Y H:i" }}</td>
                  <td>
                      <a href="{% url 'approve_booking' booking.id %}" class="btn btn-success btn-sm me-2">Approve</a>
                      <a href="{% url 'reject_booking' booking.id %}" class="btn btn-danger btn-sm">Reject</a>
                  </td>
              </tr>
              {% empty %}
              <tr><td colspan="5" class="text-center">No pending bookings</td></tr>
              {% endfor %}
          </tbody>
      </table>
  </div>

</section>
{% endblock %}
